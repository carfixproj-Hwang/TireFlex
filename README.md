# 정비 플랫폼 

- 나의 정비 내역 불러오기( my/history)
- 회원관리하기 ( admin/users )
  - 직원관리 (admin/staff(직원 전용), owner/staff(사장님 전용))
- 아이디 비밀번호 재설정 만들기
  - URL 은 에러가 발생해, 코드 인증으로 변경함.
  - 비밀번호 재설정 완료



## 수정/업데이트 필요 사항

- 몇일 작업은 하나의 작업으로 저장할 수있게하기.
- 견적서 자동 출력
- 매출 관리 하는것
  - 매출 넣기( 유동적으로 금액 넣기_사람마다 다름 )



## 앞으로의 계획

1. **“5일짜리(멀티데이) 예약 생성”부터 끝까지 확실히 고치기**

- 지금 가장 큰 상품(하이캠 같은 7200분)이 막히면 매출 동선이 끊겨.
- 체크 포인트: `create_reservation` RPC가 **workdays 아이템을 “여러 segment 예약”으로 쪼개고**, 각 segment에 `root_reservation_id / segment_no`를 **항상 채우는지**(이전에 NOT NULL 에러 있었음).
- 또 체크: “중간 차단/휴무가 있으면 건너뛰기” 로직이 **실제 운영 설정(영업일/오픈요일/휴무/blocked)** 기준으로 정확히 다음 영업일로 밀리는지.

1. **테스트를 자동화해서 ‘안정화’를 숫자로 만들기**

- Playwright(E2E): “로그인 → 예약조회 → 예약생성(분/5일) → 관리자 캘린더에서 이동 → 상태 변경” 시나리오.
- DB 레벨 테스트(최소): `create_reservation` / `admin_reschedule_reservation` / `get_available_slots`에 대해 케이스별로 결과 검증.
- 목표: 배포 전 버튼 한 번으로 “핵심 플로우가 안 깨짐” 확인.

1. **관측(Observability) 넣기**

- 서버(FastAPI/Edge/RPC)든 프론트든 지금은 “깨지면 사용자 제보로 앎” 상태일 확률이 큼.
- 최소 구성:
  - 프론트: 에러/성공 이벤트 로깅(예약생성 실패 사유, RPC error code)
  - 서버/DB: RPC별 실패율, 평균 응답시간, 가장 많은 에러 메시지 Top N
- “어디가 아픈지”가 보이면 안정화가 진짜 안정화가 돼.

1. **권한/RLS/관리자 흐름 보안 점검**

- 관리자 페이지는 특히 “RLS 정책 중복” 경고도 있었고, 기능이 늘수록 구멍이 생겨.
- 점검: 예약/차단/아이템 CRUD가 **관리자만** 되는지, anon/auth role에서 우회 가능한 쿼리 없는지.

1. **운영 기능 우선순위**

- 현실적으로 운영자가 매일 쓰는 건:
  - 오늘 예약 한 눈에 보기
  - 멀티데이 작업의 진행(세그먼트) 상태
  - 차단/휴무 처리
  - 고객 연락/메모
- 그래서 다음 기능으로는 “**멀티데이 예약을 캘린더에서 보기 좋게**(1건처럼 보이되 내부는 segments)”를 제일 먼저 잡겠어.

원하면 내가 “다음 작업 순서 체크리스트”를 너 프로젝트 상황에 맞게 10개 항목 정도로 딱 끊어서 만들어줄게.







